@using Umbraco.Cms.Web.Common.PublishedModels;
@inherits Umbraco.Cms.Web.Common.Views.UmbracoViewPage<ContentModels.OpenLibrary>
@using ContentModels = Umbraco.Cms.Web.Common.PublishedModels;
@{
	Layout = "Master.cshtml";
	var selection = Umbraco.ContentAtRoot().FirstOrDefault()
	.Descendants()
    .OfType<LibraryItem>()
    .Where(x => x.IsVisible())
    .OrderByDescending(x => x.CreateDate);
}



  <main class="container my-5">
    <header class="d-flex flex-column flex-md-row align-items-md-center justify-content-between mb-4">
      <div>
        <h1 class="h2 fw-bold mb-2">@Model.Value("title")</h1>
        <p class="text-muted-ink mb-0">@Model.Value("description")</p>
      </div>
      <button class="btn btn-accent mt-3 mt-md-0" data-bs-toggle="modal" data-bs-target="#submitModal"><i class="bi bi-plus-circle me-1"></i> Submit Project</button>
    </header>

    <div class="card-clean p-4 mb-4">
      <div class="row g-3 align-items-center">
        <div class="col-md-6">
          <input id="searchInput" type="text" class="form-control" placeholder="Search projects..." />
        </div>
        <div class="col-md-6 text-md-end">
          <div class="btn-group" role="group">
            <button class="btn btn-outline-accent active" data-filter="all">All</button>
            <button class="btn btn-outline-accent" data-filter="AI">AI</button>
            <button class="btn btn-outline-accent" data-filter="Content">Content</button>
            <button class="btn btn-outline-accent" data-filter="Security">Security</button>
            <button class="btn btn-outline-accent" data-filter="Other">Other</button>
          </div>
        </div>
      </div>
    </div>

    <div id="projectGrid" class="row g-4">

	@foreach (var item in selection)
	{
	    <div class="col-12 col-md-6 col-xl-4 project-card" data-category="@item.Tags.FirstOrDefault()" data-author="@item.Author">
        <article class="card-clean h-100 p-4">
          <h3 class="h5 mb-2">@item.Title</h3>
          <p class="small text-muted-ink mb-3">@item.Description</p>
          <div class="d-flex flex-wrap gap-2 mb-3">
              @foreach(var tag in item.Tags){
                 <span class="chip chip-blue">@tag</span>
              }
            <span class="chip">@item.Author</span>
          </div>
          <a href="@item.Link" class="btn btn-sm btn-outline-accent" target="_blank"><i class="bi bi-github me-1"></i> View on GitHub</a>
        </article>
      </div>
	}
    </div>
  </main>

  <div class="modal fade" id="submitModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content card-clean p-3">
        <div class="modal-header border-0 pb-0">
          <h5 class="modal-title fw-bold">Submit a New Project</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form id="projectForm">
            <div class="mb-3">
              <label class="form-label">Project Name</label>
              <input type="text" class="form-control" name="name" required />
            </div>
            <div class="mb-3">
              <label class="form-label">Description</label>
              <textarea class="form-control" name="description" rows="3" required></textarea>
            </div>
            <div class="mb-3">
              <label class="form-label">Category</label>
              <select class="form-select" name="category" required>
                <option value="">Choose...</option>
                <option>AI</option>
                <option>Content</option>
                <option>Security</option>
                <option>Other</option>
              </select>
            </div>
            <div class="mb-3">
              <label class="form-label">Author</label>
              <input type="text" class="form-control" name="author" required />
            </div>
            <div class="mb-3">
              <label class="form-label">GitHub URL</label>
              <input type="url" class="form-control" name="github" required />
            </div>
            <button type="submit" class="btn btn-accent w-100">Submit Project</button>
          </form>
        </div>
      </div>
    </div>
  </div>